"use strict";var WPFormsChallenge=window.WPFormsChallenge||{};WPFormsChallenge.embed=window.WPFormsChallenge.embed||function(e,p){var n={init:function(){p(n.ready),p(e).on("load",function(){"function"==typeof p.ready.then?p.ready.then(n.load):n.load()})},ready:function(){n.setup(),n.events(),n.observeFullscreenMode()},load:function(){if(-1<e.location.href.indexOf("post-new.php"))return n.lastStep(),void p(".wpforms-challenge-dot-completed").hide();WPFormsChallenge.core.isGutenberg()?WPFormsChallenge.core.initTooltips(5,".block-editor .edit-post-header",{side:"bottom"}):WPFormsChallenge.core.initTooltips(5,".wpforms-insert-form-button",{side:"right"}),WPFormsChallenge.core.updateTooltipUI()},setup:function(){5===WPFormsChallenge.core.loadStep()&&(p(".wpforms-challenge").addClass("wpforms-challenge-completed"),n.showPopup()),p(".wpforms-challenge").show()},events:function(){p(".wpforms-challenge-step5-done").on("click",n.lastStep),p(".wpforms-challenge-popup-close, .wpforms-challenge-popup-rate-btn, .wpforms-challenge-end").on("click",n.completeChallenge),p("#wpforms-challenge-contact-form .wpforms-challenge-popup-contact-btn").on("click",n.submitContactForm)},lastStep:function(){WPFormsChallenge.core.timer.pause(),WPFormsChallenge.core.stepCompleted(5),p(".wpforms-challenge").addClass("wpforms-challenge-completed"),n.showPopup()},showPopup:function(){var e=WPFormsChallenge.core.timer.getSecondsLeft();p(".wpforms-challenge-popup-container").show(),0<e?(e=WPFormsChallenge.core.timer.getSecondsSpent(e),p("#wpforms-challenge-congrats-minutes").text(WPFormsChallenge.core.timer.getMinutesFormatted(e)),p("#wpforms-challenge-congrats-seconds").text(WPFormsChallenge.core.timer.getSecondsFormatted(e)),p("#wpforms-challenge-congrats-popup").show()):p("#wpforms-challenge-contact-popup").show()},hidePopup:function(){p(".wpforms-challenge-popup-container").hide(),p(".wpforms-challenge-popup").hide()},completeChallenge:function(){var e={status:"completed",seconds_spent:WPFormsChallenge.core.timer.getSecondsSpent(),seconds_left:WPFormsChallenge.core.timer.getSecondsLeft()};n.hidePopup(),WPFormsChallenge.core.removeChallengeUI(),WPFormsChallenge.core.clearLocalStorage(),WPFormsChallenge.admin.saveChallengeOption(e).done(WPFormsChallenge.core.triggerPageSave)},submitContactForm:function(e){e.preventDefault();var o=p(this),e=o.closest("#wpforms-challenge-contact-form"),e={action:"wpforms_challenge_send_contact_form",_wpnonce:WPFormsChallenge.admin.l10n.nonce,contact_data:{message:e.find(".wpforms-challenge-contact-message").val(),contact_me:e.find(".wpforms-challenge-contact-permission").prop("checked")}};o.prop("disabled",!0),p.post(ajaxurl,e,function(e){e.success||console.error("Error sending WPForms Challenge Contact Form.")}).done(n.completeChallenge)},observeFullscreenMode:function(){var a=p("body"),c=a.hasClass("is-fullscreen-mode"),e={targetNode:a[0],config:{attributes:!0},callback:function(e,o){var n,t,l,s=p(".wpforms-challenge-tooltip-step5"),r=s.find(".tooltipster-arrow");for(l in e)"attributes"===(n=e[l]).type&&"class"===n.attributeName&&(t=a.hasClass("is-fullscreen-mode"))!==c&&((c=t)?(s.css({top:"93px",left:"0"}),r.css("left","91px")):(s.css({top:"125px",left:"66px"}),r.css("left","130px")))}};e.observer=new MutationObserver(e.callback),e.observer.observe(e.targetNode,e.config)}};return n}((document,window),jQuery),WPFormsChallenge.embed.init();